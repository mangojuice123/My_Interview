- [常见问题](#常见问题)
  - [什么是数据库的水平拆分、垂直拆分？](#什么是数据库的水平拆分垂直拆分)
- [公司](#公司)


</br></br>

![主从复制](https://pic2.zhimg.com/80/v2-92c37e8a96eaf4535fdf9533ffaadf8a_720w.png)

# 常见问题
## 什么是数据库的水平拆分、垂直拆分？
答：
- 水平拆分：将一张表的数据拆分到多个表中。这样每张表的表结构是相同的，但是数据不同。
    - 拆分方式：
        1. **主键取模处理**（对数据库的更新必须也进行取模，计算出需要写入的是哪张表）
        2. 通过时间分表（每月生成新的表）
        3. 通过范围分表（超过一定数据量即分表）
    - 分表后，查询会比以前复杂，通常不建议 `join`，一般的做法是两次查询。
- 垂直拆分：将一张表的字段拆分为主表以及扩展表，使用频次较高的字段在一张表，其余的在一张表。
    - 多表查询不建议使用 `join`，使用两次查询。
- 拆分带来的问题：事务如何保证？
  - 最终一致性方案：业务 A 调用 B，两个执行成果才算最终成功。B 失败时，通过 MQ 将消息告诉 A，A 进行回滚（A 的回滚必须是幂等的，否则 B 重复发消息会带来问题）。



</br></br>


# 公司
- 2021-11 小米