- [基础概念](#基础概念)
  - [CAS（Compare And Swap）](#cascompare-and-swap)
  - [自旋锁与非自旋锁](#自旋锁与非自旋锁)
  - [synchronized](#synchronized)
    - [无锁](#无锁)
    - [偏向锁](#偏向锁)
    - [轻量级锁](#轻量级锁)
    - [重量级锁](#重量级锁)
  - [公平锁与非公平锁](#公平锁与非公平锁)
  - [可重入锁与非可重入锁](#可重入锁与非可重入锁)
- [常见问题](#常见问题)
- [公司](#公司)


</br></br>


# 基础概念
## CAS（Compare And Swap）
- 乐观锁使用 CAS 算法实现，CAS 中包含了自旋的机制（直到设置成功才能退出循环）
- CAS 的问题：
  - ABA 问题：内存值变化 A -> B -> A，在 CAS 看来内存值没有发生改变，但是实际上是有变化的。解决方法：在变量前增加版本号。
  - 循环时间长开销大：CAS 操作如果长时间不成功，会导致其一直自旋，给 CPU 带来很大开销。
  - 只能保证一个共享变量的原子操作。

## 自旋锁与非自旋锁
![示意图](https://mmbiz.qpic.cn/mmbiz_png/hEx03cFgUsXibicYtRt824nicRjKGTibicl7atsAOXEVNheMmSrqJ9Wo1cmgxVv9kB26bjB2TDxz9kp1vrWel8rJKrw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

## synchronized
### 无锁
- 无锁没有对资源进行锁定，所有的线程都能访问并修改同一个资源，但同时只有一个线程能修改成功。
- 典型应用：CAS

### 偏向锁
- 偏向锁是指一段同步代码一直被一个线程所访问，那么该线程会自动获取锁，降低获取锁的代价。

### 轻量级锁
- 是指当锁是偏向锁的时候，被另外的线程所访问，偏向锁就会升级为轻量级锁，其他线程会通过自旋的形式尝试获取锁，不会阻塞，从而提高性能。
- 若当前只有一个等待线程，则该线程通过自旋进行等待。但是当自旋超过一定的次数，或者一个线程在持有锁，一个在自旋，又有第三个来访时，轻量级锁升级为重量级锁。

### 重量级锁
- 等待锁的线程都会进入阻塞状态。

## 公平锁与非公平锁
- 公平锁就是通过同步队列来实现多个线程按照申请锁的顺序来获取锁，从而实现公平的特性。
- 非公平锁加锁时不考虑排队等待问题，直接尝试获取锁，所以存在后申请却先获得锁的情况。

## 可重入锁与非可重入锁
- 可重入锁
![可重入锁](https://mmbiz.qpic.cn/mmbiz_png/hEx03cFgUsXibicYtRt824nicRjKGTibicl7aeUJpuv8OqtQ6Wxx4o2QQzYddTpYgsAhxl4gABpJrbXCCrrxv4eSKog/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

- 非可重入锁
![非可重入锁](https://mmbiz.qpic.cn/mmbiz_png/hEx03cFgUsXibicYtRt824nicRjKGTibicl7aWIiak9zgQ3Mic4pIxcxn7oLplME8kjubPwiabeKnUz4ibVvwaL6svNTo4A/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)


</br></br>


# 常见问题


</br></br>


# 公司